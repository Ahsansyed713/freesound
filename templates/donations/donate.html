{% extends "base.html" %}
{% load absurl %}

{% block content %}
<div id="content_full"> <!-- START of Content area -->

  <h1>Donations</h1>
  <p>
  Thanks for supporting Freesound! Please choose the name that will appear with the donation:
  </p>
  <!-- donations -->
    <div id="donation_form">
      <form method="post" action="{% url 'donate' %}">
        <ul style="list-style-type: none;">
        {% csrf_token %}
        {% if user.is_authenticated %}
          <li style="line-height: 24px;"><input type="radio" name="annon" value="0"> {{user.username}}</li>
        {% endif %}
          <li><input type="radio" name="annon" value="1" checked="checked"> Anonymous</li>
          <li><input type="radio" name="annon" value="2"> Other: <input type="text" name="name_option"></li>
        </ul>
        <input type="submit" value="Donate Now" class="donation_button" />
      </form>
    </div>
    <script type="text/javascript">
      $(document).ready(function (){
      
        $('#donation_form form').submit(function(e) {
          $.ajax({
            type: $(this).attr('method'),
            url: $(this).attr('action'),
            data: $(this).serialize(), // serializes the form's elements.
            success: function(data)
            {
              form = $('<form />', {
                action: data.url,
                method: "POST",
                style: 'display: none;'
              });
              $.each(data.params,function (name, value) {
                $('<input />', {
                  type: 'hidden',
                  name: name,
                  value: value
                }).appendTo(form);
              });
              form.appendTo('body').submit();
            }
          });
          e.preventDefault(); // avoid to execute the actual submit of the form.          
        });
      });
    </script>
    <div>
      <ul style="list-style-type: none;"><li><a href="{% url 'donors' %}">See full list of donations</a></li></ul>
    </div>
{% block section_content %}

{% endblock %}
</div> <!-- END of Content area -->

<br class="clear" />

{% endblock %}


