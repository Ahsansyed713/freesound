package  {    import flash.display.Bitmap;    import flash.display.Loader;    import flash.display.Sprite;    import flash.events.Event;    import flash.events.IOErrorEvent;    import flash.net.URLRequest;        /**     * @author bram     */    public class SoundDisplay extends Sprite     {    	private var _waveformUrl:String;    	private var _waveformImage:Bitmap;    	private var _spectralUrl:String;    	private var _spectralImage:Bitmap;    	    	private var _loading:Sprite;    	private var _playing:Sprite;    	private var _background:Sprite;        public function SoundDisplay(width:int, height:int, waveformUrl:String, spectralUrl:String)        {        	_background = new Sprite();        	addChild(_background);        	        	_waveformUrl = waveformUrl;        	_spectralUrl = spectralUrl;        	        	_loading = new Sprite();        	_loading.graphics.beginFill(0xff0000, 0.5);        	_loading.graphics.drawRect(0, 0, width, height);        	        	_playing = new Sprite();        	_playing.graphics.lineStyle(1, 0xff0000);        	_playing.graphics.moveTo(0, 0);        	_playing.graphics.lineTo(0, height-1);        	_playing.x = 20;        	        	loadWaveformImage();        }                public function startLoading():void        {        	if (!contains(_loading))	        	addChild(_loading);        }                public function setLoading(procent:Number):void        {        	if (procent >= 1.0)        	{        		if (contains(_loading))        			removeChild(_loading);        		return;        	}        	        	_loading.graphics.clear();        	_loading.graphics.beginFill(0xffffff, 0.5);        	_loading.graphics.drawRect(width*procent, 0, width*(1.0 - procent), height);        }                public function startPlaying():void        {        	if (!contains(_playing))	        	addChild(_playing);        }                public function setPlaying(procent:Number):void        {        	if (procent <= 1)        	{        		_playing.x = width*procent;        	}        }        public function stopPlaying():void        {        	if (contains(_playing))	        	removeChild(_playing);        }                public function swapDisplayImage():void        {        	if (!_spectralImage)        		loadSpectralImage();        		        	if (_waveformImage && _spectralImage)    			_background.swapChildren(_waveformImage, _spectralImage);        }        private function loadWaveformImage():void        {        	var loader:Loader = new Loader();        	loader.contentLoaderInfo.addEventListener(Event.COMPLETE, function (e:Event) : void {	        	_waveformImage = Bitmap(loader.content);    	    	_background.addChild(_waveformImage);            });        	loader.load(new URLRequest(_waveformUrl));        }                private function loadSpectralImage():void    	{        	var loader:Loader = new Loader();        	loader.contentLoaderInfo.addEventListener(Event.COMPLETE, function (e:Event) : void {				_spectralImage = Bitmap(loader.content);    	    	_background.addChild(_spectralImage);        	});        	loader.load(new URLRequest(_spectralUrl));    	}    }}